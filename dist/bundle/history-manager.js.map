{"version":3,"file":"history-manager.js","sources":["../../node_modules/tslib/tslib.es6.js","../../node_modules/path-to-regexp/dist.es2015/index.js","../../src/PathGenerator.ts","../../src/ContextManager.ts","../../node_modules/strict-uri-encode/index.js","../../node_modules/decode-uri-component/index.js","../../node_modules/split-on-first/index.js","../../node_modules/query-string/index.js","../../src/OptionsManager.ts","../../src/URLManager.ts","../../src/HistoryManager.ts","../../src/NavigationLock.ts","../../src/Router.ts","../../src/WorkManager.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) __createBinding(exports, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","/**\n * Tokenize input string.\n */\nfunction lexer(str) {\n    var tokens = [];\n    var i = 0;\n    while (i < str.length) {\n        var char = str[i];\n        if (char === \"*\" || char === \"+\" || char === \"?\") {\n            tokens.push({ type: \"MODIFIER\", index: i, value: str[i++] });\n            continue;\n        }\n        if (char === \"\\\\\") {\n            tokens.push({ type: \"ESCAPED_CHAR\", index: i++, value: str[i++] });\n            continue;\n        }\n        if (char === \"{\") {\n            tokens.push({ type: \"OPEN\", index: i, value: str[i++] });\n            continue;\n        }\n        if (char === \"}\") {\n            tokens.push({ type: \"CLOSE\", index: i, value: str[i++] });\n            continue;\n        }\n        if (char === \":\") {\n            var name = \"\";\n            var j = i + 1;\n            while (j < str.length) {\n                var code = str.charCodeAt(j);\n                if (\n                // `0-9`\n                (code >= 48 && code <= 57) ||\n                    // `A-Z`\n                    (code >= 65 && code <= 90) ||\n                    // `a-z`\n                    (code >= 97 && code <= 122) ||\n                    // `_`\n                    code === 95) {\n                    name += str[j++];\n                    continue;\n                }\n                break;\n            }\n            if (!name)\n                throw new TypeError(\"Missing parameter name at \" + i);\n            tokens.push({ type: \"NAME\", index: i, value: name });\n            i = j;\n            continue;\n        }\n        if (char === \"(\") {\n            var count = 1;\n            var pattern = \"\";\n            var j = i + 1;\n            if (str[j] === \"?\") {\n                throw new TypeError(\"Pattern cannot start with \\\"?\\\" at \" + j);\n            }\n            while (j < str.length) {\n                if (str[j] === \"\\\\\") {\n                    pattern += str[j++] + str[j++];\n                    continue;\n                }\n                if (str[j] === \")\") {\n                    count--;\n                    if (count === 0) {\n                        j++;\n                        break;\n                    }\n                }\n                else if (str[j] === \"(\") {\n                    count++;\n                    if (str[j + 1] !== \"?\") {\n                        throw new TypeError(\"Capturing groups are not allowed at \" + j);\n                    }\n                }\n                pattern += str[j++];\n            }\n            if (count)\n                throw new TypeError(\"Unbalanced pattern at \" + i);\n            if (!pattern)\n                throw new TypeError(\"Missing pattern at \" + i);\n            tokens.push({ type: \"PATTERN\", index: i, value: pattern });\n            i = j;\n            continue;\n        }\n        tokens.push({ type: \"CHAR\", index: i, value: str[i++] });\n    }\n    tokens.push({ type: \"END\", index: i, value: \"\" });\n    return tokens;\n}\n/**\n * Parse a string for the raw tokens.\n */\nexport function parse(str, options) {\n    if (options === void 0) { options = {}; }\n    var tokens = lexer(str);\n    var _a = options.prefixes, prefixes = _a === void 0 ? \"./\" : _a;\n    var defaultPattern = \"[^\" + escapeString(options.delimiter || \"/#?\") + \"]+?\";\n    var result = [];\n    var key = 0;\n    var i = 0;\n    var path = \"\";\n    var tryConsume = function (type) {\n        if (i < tokens.length && tokens[i].type === type)\n            return tokens[i++].value;\n    };\n    var mustConsume = function (type) {\n        var value = tryConsume(type);\n        if (value !== undefined)\n            return value;\n        var _a = tokens[i], nextType = _a.type, index = _a.index;\n        throw new TypeError(\"Unexpected \" + nextType + \" at \" + index + \", expected \" + type);\n    };\n    var consumeText = function () {\n        var result = \"\";\n        var value;\n        // tslint:disable-next-line\n        while ((value = tryConsume(\"CHAR\") || tryConsume(\"ESCAPED_CHAR\"))) {\n            result += value;\n        }\n        return result;\n    };\n    while (i < tokens.length) {\n        var char = tryConsume(\"CHAR\");\n        var name = tryConsume(\"NAME\");\n        var pattern = tryConsume(\"PATTERN\");\n        if (name || pattern) {\n            var prefix = char || \"\";\n            if (prefixes.indexOf(prefix) === -1) {\n                path += prefix;\n                prefix = \"\";\n            }\n            if (path) {\n                result.push(path);\n                path = \"\";\n            }\n            result.push({\n                name: name || key++,\n                prefix: prefix,\n                suffix: \"\",\n                pattern: pattern || defaultPattern,\n                modifier: tryConsume(\"MODIFIER\") || \"\"\n            });\n            continue;\n        }\n        var value = char || tryConsume(\"ESCAPED_CHAR\");\n        if (value) {\n            path += value;\n            continue;\n        }\n        if (path) {\n            result.push(path);\n            path = \"\";\n        }\n        var open = tryConsume(\"OPEN\");\n        if (open) {\n            var prefix = consumeText();\n            var name_1 = tryConsume(\"NAME\") || \"\";\n            var pattern_1 = tryConsume(\"PATTERN\") || \"\";\n            var suffix = consumeText();\n            mustConsume(\"CLOSE\");\n            result.push({\n                name: name_1 || (pattern_1 ? key++ : \"\"),\n                pattern: name_1 && !pattern_1 ? defaultPattern : pattern_1,\n                prefix: prefix,\n                suffix: suffix,\n                modifier: tryConsume(\"MODIFIER\") || \"\"\n            });\n            continue;\n        }\n        mustConsume(\"END\");\n    }\n    return result;\n}\n/**\n * Compile a string to a template function for the path.\n */\nexport function compile(str, options) {\n    return tokensToFunction(parse(str, options), options);\n}\n/**\n * Expose a method for transforming tokens into the path function.\n */\nexport function tokensToFunction(tokens, options) {\n    if (options === void 0) { options = {}; }\n    var reFlags = flags(options);\n    var _a = options.encode, encode = _a === void 0 ? function (x) { return x; } : _a, _b = options.validate, validate = _b === void 0 ? true : _b;\n    // Compile all the tokens into regexps.\n    var matches = tokens.map(function (token) {\n        if (typeof token === \"object\") {\n            return new RegExp(\"^(?:\" + token.pattern + \")$\", reFlags);\n        }\n    });\n    return function (data) {\n        var path = \"\";\n        for (var i = 0; i < tokens.length; i++) {\n            var token = tokens[i];\n            if (typeof token === \"string\") {\n                path += token;\n                continue;\n            }\n            var value = data ? data[token.name] : undefined;\n            var optional = token.modifier === \"?\" || token.modifier === \"*\";\n            var repeat = token.modifier === \"*\" || token.modifier === \"+\";\n            if (Array.isArray(value)) {\n                if (!repeat) {\n                    throw new TypeError(\"Expected \\\"\" + token.name + \"\\\" to not repeat, but got an array\");\n                }\n                if (value.length === 0) {\n                    if (optional)\n                        continue;\n                    throw new TypeError(\"Expected \\\"\" + token.name + \"\\\" to not be empty\");\n                }\n                for (var j = 0; j < value.length; j++) {\n                    var segment = encode(value[j], token);\n                    if (validate && !matches[i].test(segment)) {\n                        throw new TypeError(\"Expected all \\\"\" + token.name + \"\\\" to match \\\"\" + token.pattern + \"\\\", but got \\\"\" + segment + \"\\\"\");\n                    }\n                    path += token.prefix + segment + token.suffix;\n                }\n                continue;\n            }\n            if (typeof value === \"string\" || typeof value === \"number\") {\n                var segment = encode(String(value), token);\n                if (validate && !matches[i].test(segment)) {\n                    throw new TypeError(\"Expected \\\"\" + token.name + \"\\\" to match \\\"\" + token.pattern + \"\\\", but got \\\"\" + segment + \"\\\"\");\n                }\n                path += token.prefix + segment + token.suffix;\n                continue;\n            }\n            if (optional)\n                continue;\n            var typeOfMessage = repeat ? \"an array\" : \"a string\";\n            throw new TypeError(\"Expected \\\"\" + token.name + \"\\\" to be \" + typeOfMessage);\n        }\n        return path;\n    };\n}\n/**\n * Create path match function from `path-to-regexp` spec.\n */\nexport function match(str, options) {\n    var keys = [];\n    var re = pathToRegexp(str, keys, options);\n    return regexpToFunction(re, keys, options);\n}\n/**\n * Create a path match function from `path-to-regexp` output.\n */\nexport function regexpToFunction(re, keys, options) {\n    if (options === void 0) { options = {}; }\n    var _a = options.decode, decode = _a === void 0 ? function (x) { return x; } : _a;\n    return function (pathname) {\n        var m = re.exec(pathname);\n        if (!m)\n            return false;\n        var path = m[0], index = m.index;\n        var params = Object.create(null);\n        var _loop_1 = function (i) {\n            // tslint:disable-next-line\n            if (m[i] === undefined)\n                return \"continue\";\n            var key = keys[i - 1];\n            if (key.modifier === \"*\" || key.modifier === \"+\") {\n                params[key.name] = m[i].split(key.prefix + key.suffix).map(function (value) {\n                    return decode(value, key);\n                });\n            }\n            else {\n                params[key.name] = decode(m[i], key);\n            }\n        };\n        for (var i = 1; i < m.length; i++) {\n            _loop_1(i);\n        }\n        return { path: path, index: index, params: params };\n    };\n}\n/**\n * Escape a regular expression string.\n */\nfunction escapeString(str) {\n    return str.replace(/([.+*?=^!:${}()[\\]|/\\\\])/g, \"\\\\$1\");\n}\n/**\n * Get the flags for a regexp from the options.\n */\nfunction flags(options) {\n    return options && options.sensitive ? \"\" : \"i\";\n}\n/**\n * Pull out keys from a regexp.\n */\nfunction regexpToRegexp(path, keys) {\n    if (!keys)\n        return path;\n    // Use a negative lookahead to match only capturing groups.\n    var groups = path.source.match(/\\((?!\\?)/g);\n    if (groups) {\n        for (var i = 0; i < groups.length; i++) {\n            keys.push({\n                name: i,\n                prefix: \"\",\n                suffix: \"\",\n                modifier: \"\",\n                pattern: \"\"\n            });\n        }\n    }\n    return path;\n}\n/**\n * Transform an array into a regexp.\n */\nfunction arrayToRegexp(paths, keys, options) {\n    var parts = paths.map(function (path) { return pathToRegexp(path, keys, options).source; });\n    return new RegExp(\"(?:\" + parts.join(\"|\") + \")\", flags(options));\n}\n/**\n * Create a path regexp from string input.\n */\nfunction stringToRegexp(path, keys, options) {\n    return tokensToRegexp(parse(path, options), keys, options);\n}\n/**\n * Expose a function for taking tokens and returning a RegExp.\n */\nexport function tokensToRegexp(tokens, keys, options) {\n    if (options === void 0) { options = {}; }\n    var _a = options.strict, strict = _a === void 0 ? false : _a, _b = options.start, start = _b === void 0 ? true : _b, _c = options.end, end = _c === void 0 ? true : _c, _d = options.encode, encode = _d === void 0 ? function (x) { return x; } : _d;\n    var endsWith = \"[\" + escapeString(options.endsWith || \"\") + \"]|$\";\n    var delimiter = \"[\" + escapeString(options.delimiter || \"/#?\") + \"]\";\n    var route = start ? \"^\" : \"\";\n    // Iterate over the tokens and create our regexp string.\n    for (var _i = 0, tokens_1 = tokens; _i < tokens_1.length; _i++) {\n        var token = tokens_1[_i];\n        if (typeof token === \"string\") {\n            route += escapeString(encode(token));\n        }\n        else {\n            var prefix = escapeString(encode(token.prefix));\n            var suffix = escapeString(encode(token.suffix));\n            if (token.pattern) {\n                if (keys)\n                    keys.push(token);\n                if (prefix || suffix) {\n                    if (token.modifier === \"+\" || token.modifier === \"*\") {\n                        var mod = token.modifier === \"*\" ? \"?\" : \"\";\n                        route += \"(?:\" + prefix + \"((?:\" + token.pattern + \")(?:\" + suffix + prefix + \"(?:\" + token.pattern + \"))*)\" + suffix + \")\" + mod;\n                    }\n                    else {\n                        route += \"(?:\" + prefix + \"(\" + token.pattern + \")\" + suffix + \")\" + token.modifier;\n                    }\n                }\n                else {\n                    route += \"(\" + token.pattern + \")\" + token.modifier;\n                }\n            }\n            else {\n                route += \"(?:\" + prefix + suffix + \")\" + token.modifier;\n            }\n        }\n    }\n    if (end) {\n        if (!strict)\n            route += delimiter + \"?\";\n        route += !options.endsWith ? \"$\" : \"(?=\" + endsWith + \")\";\n    }\n    else {\n        var endToken = tokens[tokens.length - 1];\n        var isEndDelimited = typeof endToken === \"string\"\n            ? delimiter.indexOf(endToken[endToken.length - 1]) > -1\n            : // tslint:disable-next-line\n                endToken === undefined;\n        if (!strict) {\n            route += \"(?:\" + delimiter + \"(?=\" + endsWith + \"))?\";\n        }\n        if (!isEndDelimited) {\n            route += \"(?=\" + delimiter + \"|\" + endsWith + \")\";\n        }\n    }\n    return new RegExp(route, flags(options));\n}\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n */\nexport function pathToRegexp(path, keys, options) {\n    if (path instanceof RegExp)\n        return regexpToRegexp(path, keys);\n    if (Array.isArray(path))\n        return arrayToRegexp(path, keys, options);\n    return stringToRegexp(path, keys, options);\n}\n//# sourceMappingURL=index.js.map","/**\r\n * @author Giuliano Collacchioni @2020\r\n */\r\n\r\nimport { pathToRegexp, Path, Key } from \"path-to-regexp\";\r\n\r\nconst LEADING_DELIMITER: RegExp = /^[\\\\\\/]+/;\r\nconst TRAILING_DELIMITER: RegExp = /[\\\\\\/]+$/;\r\nconst DELIMITER_NOT_IN_PARENTHESES: RegExp = /[\\\\\\/]+(?![^(]*[)])/g;\r\n\r\nexport function prepare(path: string): string {\r\n    return path.replace(LEADING_DELIMITER, \"\").replace(TRAILING_DELIMITER, \"\").replace(DELIMITER_NOT_IN_PARENTHESES, \"/\");\r\n}\r\nexport function generate(path: Path, keys?: Key[]): RegExp {\r\n    if (Array.isArray(path)) {\r\n        path.map(value => {\r\n            if (typeof value === \"string\") {\r\n                return prepare(value);\r\n            }\r\n            return value;\r\n        });\r\n    }\r\n    if (typeof path === \"string\") {\r\n        path = prepare(path);\r\n    }\r\n    return pathToRegexp(path, keys); // , { end: false }); // is this needed?\r\n}","import * as PathGenerator from \"./PathGenerator\";\r\n\r\nexport class ContextManager {\r\n    private _contexts: ContextsMap = new Map();\r\n    private _hrefs: HREFsArray = [];\r\n    private _index: number = -1;\r\n    private _length: number = 0;\r\n    /**\r\n     * Removes all references after the actual index\r\n     */\r\n    clean(): void {\r\n        if (this._index < this._length - 1) {\r\n            let index: number = this._index;\r\n            let newHREFs: HREFsArray = [];\r\n            this._hrefs.some(c_hrefs => {\r\n                let newCHrefs: string[] = [];\r\n                let result: boolean = c_hrefs[1].some(href => {\r\n                    // if index is still greater or equal to 0\r\n                    // then keep the reference else stop the loop\r\n                    if (index-- >= 0) {\r\n                        newCHrefs.push(href);\r\n                        return false;\r\n                    }\r\n                    return true;\r\n                });\r\n                if (newCHrefs.length) {\r\n                    newHREFs.push([c_hrefs[0], newCHrefs]);\r\n                }\r\n                return result;\r\n            });\r\n            this._hrefs = newHREFs;\r\n            this._length = this._index + 1;\r\n        }\r\n    }\r\n    currentContext(): string | null {\r\n        if (this._hrefs.length === 0) {\r\n            return null;\r\n        }\r\n        let index: number = this._index;\r\n        let context: string;\r\n        if (this._hrefs.some(([c, hrefs]) => {\r\n            context = c;\r\n            index -= hrefs.length;\r\n            return index < 0;\r\n        })) {\r\n            return context!;\r\n        }\r\n        return null;\r\n    }\r\n    contextOf(href: string, skipFallback: boolean = true): string | null {\r\n        let foundContext: string | null = null;\r\n        href = href.split(\"#\")[0].split(\"?\")[0];\r\n        for (let [context, [hrefs]] of this._contexts.entries()) {\r\n            if (hrefs.some(c_href => {\r\n                if (c_href!.fallback && skipFallback) {\r\n                    return false;\r\n                }\r\n                return c_href.path.test(href);\r\n            })) {\r\n                foundContext = context;\r\n                break;\r\n            }\r\n        }\r\n        return foundContext;\r\n    }\r\n    insert(href: string, replace: boolean = false): void {\r\n        this.clean();\r\n        // console.group(`ContextManager.insert(\"${href}\", ${replace})`);\r\n        // console.log(`current href: ${this.hrefs()}`);\r\n        // get context of href\r\n        let foundContext: string | null = this.contextOf(href, this._length > 0);\r\n        // console.log(`found context: ${foundContext}`);\r\n        let previousContext: HREFsArray[0] | null = this._hrefs.length > 0 ? this._hrefs[this._hrefs.length - 1] : null;\r\n        if (foundContext == null) {\r\n            if (this._hrefs.length > 0) {\r\n                this._hrefs[this._hrefs.length - 1][1].push(href);\r\n                this._length++;\r\n                this._index++;\r\n            }\r\n        } else {\r\n            let i: number = -1;\r\n            if (this._hrefs.some((c_hrefs, index) => {\r\n                if (c_hrefs[0] === foundContext) {\r\n                    i = index;\r\n                    return true;\r\n                }\r\n                return false;\r\n            })) {\r\n                let c_hrefs: [string, string[]] = this._hrefs.splice(i, 1)[0];\r\n                if (href !== c_hrefs[1][c_hrefs[1].length - 1]) {\r\n                    c_hrefs[1].push(href);\r\n                    this._length++;\r\n                    this._index++;\r\n                }\r\n                this._hrefs.push(c_hrefs);\r\n            } else {\r\n                this._hrefs.push([foundContext, [href]]);\r\n                this._length++;\r\n                this._index++;\r\n            }\r\n        }\r\n        if (replace && this._hrefs.length > 0) {\r\n            let lastContext: HREFsArray[0] = this._hrefs[this._hrefs.length - 1];\r\n            // console.log(\"replacing\");\r\n            if (previousContext != null) {\r\n                // console.log(`last context: [\"${ previousContext[0] }\", [${ previousContext[1] }] ]`);\r\n            } else {\r\n                // console.log(\"last context: null\");\r\n            }\r\n            // console.log(`current context: [\"${ lastContext[0] }\", [${ lastContext[1] }]]`);\r\n            if (lastContext === previousContext) {\r\n                if (lastContext[1].length > 1) {\r\n                    do {\r\n                        lastContext[1].splice(-2, 1);\r\n                        this._length--;\r\n                        this._index--;\r\n                    } while (\r\n                        lastContext[1].length > 1 &&\r\n                        lastContext[1][lastContext[1].length - 2] === href\r\n                    );\r\n                    // console.log(`final hrefs: ${ lastContext[1] }`);\r\n                }\r\n            } else if (previousContext != null) {\r\n                previousContext[1].splice(-1, 1);\r\n                this._length--;\r\n                this._index--;\r\n            }\r\n        }\r\n        // console.groupEnd();\r\n    }\r\n    goBackward(): string {\r\n        // console.group(\"ContextManager.goBackward()\");\r\n        // console.log(`current index: ${this._index}`);\r\n        this._index = Math.max(--this._index, 0);\r\n        // console.log(`new index: ${this._index}`);\r\n        // console.groupEnd();\r\n        return this.get()!;\r\n    }\r\n    goForward(): string {\r\n        // console.group(\"ContextManager.goForward()\");\r\n        // console.log(`current index: ${this._index}`);\r\n        this._index = Math.min(++this._index, this._length - 1);\r\n        // console.log(`new index: ${this._index}`);\r\n        // console.groupEnd();\r\n        return this.get()!;\r\n    }\r\n    get(index: number = this._index): string | null {\r\n        let href: string;\r\n        if (this._hrefs.some(([c, hrefs]) => {\r\n            let length: number = hrefs.length;\r\n            if (index >= length) {\r\n                index -= length;\r\n                return false;\r\n            }\r\n            href = hrefs[index];\r\n            return true;\r\n        })) {\r\n            return href!;\r\n        }\r\n        return null;\r\n    }\r\n    index(): number;\r\n    index(value: number): void;\r\n    index(value?: number): void | number {\r\n        if (value === void 0) {\r\n            return this._index;\r\n        }\r\n        value = parseInt(value as any, 10);\r\n        if (isNaN(value)) {\r\n            throw new Error(\"value must be a number\");\r\n        }\r\n        // console.group(`ContextManager.index(${value})`);\r\n        // console.log(`current hrefs: ${this.hrefs()}`);\r\n        this._index = value;\r\n        // console.groupEnd();\r\n    }\r\n    length(): number {\r\n        return this._length;\r\n    }\r\n    getContextNames(): string[] {\r\n        return Array.from(this._contexts.keys());\r\n    }\r\n    getDefaultOf(context: string): string | null {\r\n        let c: ContextInfo | undefined = this._contexts.get(context);\r\n        if (!c) {\r\n            return null;\r\n        }\r\n        let href: string | null | undefined = c[1];\r\n        if (href == null) {\r\n            return null;\r\n        }\r\n        return href;\r\n    }\r\n    restore(context: string): boolean {\r\n        let tmpHREFs: HREFsArray = this._hrefs;\r\n        this.clean();\r\n        if (this._hrefs.length) {\r\n            let lastContext: HREFsArray[0] = this._hrefs[this._hrefs.length - 1];\r\n            if (lastContext[0] === context) {\r\n                let path: string = this._contexts.get(context)![1] || lastContext[1][0];\r\n                let numPages: number = lastContext[1].splice(1).length;\r\n                this._length -= numPages;\r\n                this._index -= numPages;\r\n                lastContext[1][0] = path;\r\n                return true;\r\n            }\r\n        }\r\n        if (!this._hrefs.some((c, i) => {\r\n            if (c[0] === context) {\r\n                if (i < this._hrefs.length - 1) {\r\n                    this._hrefs.push(this._hrefs.splice(i, 1)[0]);\r\n                }\r\n                return true;\r\n            }\r\n            return false;\r\n        })) {\r\n            let c: ContextInfo | undefined = this._contexts.get(context);\r\n            if (c == null) {\r\n                this._hrefs = tmpHREFs;\r\n                return false;\r\n            }\r\n            let href: string | null | undefined = c[1];\r\n            if (href != null) {\r\n                this.insert(href);\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    addContextPath(context_name: string, path: string, fallback: boolean = false): RegExp {\r\n        let pathRegexp: RegExp = PathGenerator.generate(path);\r\n        let context: ContextInfo | undefined = this._contexts.get(context_name);\r\n        if (context == null) {\r\n            this._contexts.set(context_name, context = [[], null]);\r\n        }\r\n        context[0].push({\r\n            path: pathRegexp,\r\n            fallback\r\n        });\r\n        return pathRegexp;\r\n    }\r\n    setContextDefaultHref(context_name: string, href: string | null): void {\r\n        let context: ContextInfo | undefined = this._contexts.get(context_name);\r\n        if (context == null) {\r\n            this._contexts.set(context_name, context = [[], null]);\r\n        }\r\n        context[1] = href;\r\n    }\r\n    setContext(context: {\r\n        name: string,\r\n        paths: { path: string, fallback?: boolean }[],\r\n        default?: string | null\r\n    }): void {\r\n        context.paths.forEach(path => {\r\n            this.addContextPath(context.name, path.path, path.fallback);\r\n        });\r\n        if (context.default !== undefined) {\r\n            this.setContextDefaultHref(context.name, context.default);\r\n        }\r\n    }\r\n    hrefs(): string[] {\r\n        let hrefs: string[] = [];\r\n        this._hrefs.forEach(([c, c_hrefs]) => {\r\n            hrefs.push.apply(hrefs, c_hrefs);\r\n        });\r\n        return hrefs;\r\n    }\r\n}\r\n\r\nexport interface IContextPath {\r\n    path: RegExp;\r\n    fallback: boolean;\r\n}\r\n\r\n// [ paths, default_href ]\r\nexport type ContextInfo = [ IContextPath[], string | null | undefined ];\r\n\r\n// ( context_name, ContextInfo )\r\nexport type ContextsMap = Map<string, ContextInfo>;\r\n\r\n// [ context_name, hrefs ][]\r\nexport type HREFsArray = [ string, string[] ][];","'use strict';\nmodule.exports = str => encodeURIComponent(str).replace(/[!'()*]/g, x => `%${x.charCodeAt(0).toString(16).toUpperCase()}`);\n","'use strict';\nvar token = '%[a-f0-9]{2}';\nvar singleMatcher = new RegExp(token, 'gi');\nvar multiMatcher = new RegExp('(' + token + ')+', 'gi');\n\nfunction decodeComponents(components, split) {\n\ttry {\n\t\t// Try to decode the entire string first\n\t\treturn decodeURIComponent(components.join(''));\n\t} catch (err) {\n\t\t// Do nothing\n\t}\n\n\tif (components.length === 1) {\n\t\treturn components;\n\t}\n\n\tsplit = split || 1;\n\n\t// Split the array in 2 parts\n\tvar left = components.slice(0, split);\n\tvar right = components.slice(split);\n\n\treturn Array.prototype.concat.call([], decodeComponents(left), decodeComponents(right));\n}\n\nfunction decode(input) {\n\ttry {\n\t\treturn decodeURIComponent(input);\n\t} catch (err) {\n\t\tvar tokens = input.match(singleMatcher);\n\n\t\tfor (var i = 1; i < tokens.length; i++) {\n\t\t\tinput = decodeComponents(tokens, i).join('');\n\n\t\t\ttokens = input.match(singleMatcher);\n\t\t}\n\n\t\treturn input;\n\t}\n}\n\nfunction customDecodeURIComponent(input) {\n\t// Keep track of all the replacements and prefill the map with the `BOM`\n\tvar replaceMap = {\n\t\t'%FE%FF': '\\uFFFD\\uFFFD',\n\t\t'%FF%FE': '\\uFFFD\\uFFFD'\n\t};\n\n\tvar match = multiMatcher.exec(input);\n\twhile (match) {\n\t\ttry {\n\t\t\t// Decode as big chunks as possible\n\t\t\treplaceMap[match[0]] = decodeURIComponent(match[0]);\n\t\t} catch (err) {\n\t\t\tvar result = decode(match[0]);\n\n\t\t\tif (result !== match[0]) {\n\t\t\t\treplaceMap[match[0]] = result;\n\t\t\t}\n\t\t}\n\n\t\tmatch = multiMatcher.exec(input);\n\t}\n\n\t// Add `%C2` at the end of the map to make sure it does not replace the combinator before everything else\n\treplaceMap['%C2'] = '\\uFFFD';\n\n\tvar entries = Object.keys(replaceMap);\n\n\tfor (var i = 0; i < entries.length; i++) {\n\t\t// Replace all decoded components\n\t\tvar key = entries[i];\n\t\tinput = input.replace(new RegExp(key, 'g'), replaceMap[key]);\n\t}\n\n\treturn input;\n}\n\nmodule.exports = function (encodedURI) {\n\tif (typeof encodedURI !== 'string') {\n\t\tthrow new TypeError('Expected `encodedURI` to be of type `string`, got `' + typeof encodedURI + '`');\n\t}\n\n\ttry {\n\t\tencodedURI = encodedURI.replace(/\\+/g, ' ');\n\n\t\t// Try the built in decoder first\n\t\treturn decodeURIComponent(encodedURI);\n\t} catch (err) {\n\t\t// Fallback to a more advanced decoder\n\t\treturn customDecodeURIComponent(encodedURI);\n\t}\n};\n","'use strict';\n\nmodule.exports = (string, separator) => {\n\tif (!(typeof string === 'string' && typeof separator === 'string')) {\n\t\tthrow new TypeError('Expected the arguments to be of type `string`');\n\t}\n\n\tif (separator === '') {\n\t\treturn [string];\n\t}\n\n\tconst separatorIndex = string.indexOf(separator);\n\n\tif (separatorIndex === -1) {\n\t\treturn [string];\n\t}\n\n\treturn [\n\t\tstring.slice(0, separatorIndex),\n\t\tstring.slice(separatorIndex + separator.length)\n\t];\n};\n","'use strict';\nconst strictUriEncode = require('strict-uri-encode');\nconst decodeComponent = require('decode-uri-component');\nconst splitOnFirst = require('split-on-first');\n\nconst isNullOrUndefined = value => value === null || value === undefined;\n\nfunction encoderForArrayFormat(options) {\n\tswitch (options.arrayFormat) {\n\t\tcase 'index':\n\t\t\treturn key => (result, value) => {\n\t\t\t\tconst index = result.length;\n\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, [encode(key, options), '[', index, ']'].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [\n\t\t\t\t\t...result,\n\t\t\t\t\t[encode(key, options), '[', encode(index, options), ']=', encode(value, options)].join('')\n\t\t\t\t];\n\t\t\t};\n\n\t\tcase 'bracket':\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, [encode(key, options), '[]'].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [...result, [encode(key, options), '[]=', encode(value, options)].join('')];\n\t\t\t};\n\n\t\tcase 'comma':\n\t\tcase 'separator':\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (value === null || value === undefined || value.length === 0) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (result.length === 0) {\n\t\t\t\t\treturn [[encode(key, options), '=', encode(value, options)].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [[result, encode(value, options)].join(options.arrayFormatSeparator)];\n\t\t\t};\n\n\t\tdefault:\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, encode(key, options)];\n\t\t\t\t}\n\n\t\t\t\treturn [...result, [encode(key, options), '=', encode(value, options)].join('')];\n\t\t\t};\n\t}\n}\n\nfunction parserForArrayFormat(options) {\n\tlet result;\n\n\tswitch (options.arrayFormat) {\n\t\tcase 'index':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tresult = /\\[(\\d*)\\]$/.exec(key);\n\n\t\t\t\tkey = key.replace(/\\[\\d*\\]$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = {};\n\t\t\t\t}\n\n\t\t\t\taccumulator[key][result[1]] = value;\n\t\t\t};\n\n\t\tcase 'bracket':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tresult = /(\\[\\])$/.exec(key);\n\t\t\t\tkey = key.replace(/\\[\\]$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = [value];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], value);\n\t\t\t};\n\n\t\tcase 'comma':\n\t\tcase 'separator':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tconst isArray = typeof value === 'string' && value.split('').indexOf(options.arrayFormatSeparator) > -1;\n\t\t\t\tconst newValue = isArray ? value.split(options.arrayFormatSeparator).map(item => decode(item, options)) : value === null ? value : decode(value, options);\n\t\t\t\taccumulator[key] = newValue;\n\t\t\t};\n\n\t\tdefault:\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], value);\n\t\t\t};\n\t}\n}\n\nfunction validateArrayFormatSeparator(value) {\n\tif (typeof value !== 'string' || value.length !== 1) {\n\t\tthrow new TypeError('arrayFormatSeparator must be single character string');\n\t}\n}\n\nfunction encode(value, options) {\n\tif (options.encode) {\n\t\treturn options.strict ? strictUriEncode(value) : encodeURIComponent(value);\n\t}\n\n\treturn value;\n}\n\nfunction decode(value, options) {\n\tif (options.decode) {\n\t\treturn decodeComponent(value);\n\t}\n\n\treturn value;\n}\n\nfunction keysSorter(input) {\n\tif (Array.isArray(input)) {\n\t\treturn input.sort();\n\t}\n\n\tif (typeof input === 'object') {\n\t\treturn keysSorter(Object.keys(input))\n\t\t\t.sort((a, b) => Number(a) - Number(b))\n\t\t\t.map(key => input[key]);\n\t}\n\n\treturn input;\n}\n\nfunction removeHash(input) {\n\tconst hashStart = input.indexOf('#');\n\tif (hashStart !== -1) {\n\t\tinput = input.slice(0, hashStart);\n\t}\n\n\treturn input;\n}\n\nfunction getHash(url) {\n\tlet hash = '';\n\tconst hashStart = url.indexOf('#');\n\tif (hashStart !== -1) {\n\t\thash = url.slice(hashStart);\n\t}\n\n\treturn hash;\n}\n\nfunction extract(input) {\n\tinput = removeHash(input);\n\tconst queryStart = input.indexOf('?');\n\tif (queryStart === -1) {\n\t\treturn '';\n\t}\n\n\treturn input.slice(queryStart + 1);\n}\n\nfunction parseValue(value, options) {\n\tif (options.parseNumbers && !Number.isNaN(Number(value)) && (typeof value === 'string' && value.trim() !== '')) {\n\t\tvalue = Number(value);\n\t} else if (options.parseBooleans && value !== null && (value.toLowerCase() === 'true' || value.toLowerCase() === 'false')) {\n\t\tvalue = value.toLowerCase() === 'true';\n\t}\n\n\treturn value;\n}\n\nfunction parse(input, options) {\n\toptions = Object.assign({\n\t\tdecode: true,\n\t\tsort: true,\n\t\tarrayFormat: 'none',\n\t\tarrayFormatSeparator: ',',\n\t\tparseNumbers: false,\n\t\tparseBooleans: false\n\t}, options);\n\n\tvalidateArrayFormatSeparator(options.arrayFormatSeparator);\n\n\tconst formatter = parserForArrayFormat(options);\n\n\t// Create an object with no prototype\n\tconst ret = Object.create(null);\n\n\tif (typeof input !== 'string') {\n\t\treturn ret;\n\t}\n\n\tinput = input.trim().replace(/^[?#&]/, '');\n\n\tif (!input) {\n\t\treturn ret;\n\t}\n\n\tfor (const param of input.split('&')) {\n\t\tlet [key, value] = splitOnFirst(options.decode ? param.replace(/\\+/g, ' ') : param, '=');\n\n\t\t// Missing `=` should be `null`:\n\t\t// http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n\t\tvalue = value === undefined ? null : ['comma', 'separator'].includes(options.arrayFormat) ? value : decode(value, options);\n\t\tformatter(decode(key, options), value, ret);\n\t}\n\n\tfor (const key of Object.keys(ret)) {\n\t\tconst value = ret[key];\n\t\tif (typeof value === 'object' && value !== null) {\n\t\t\tfor (const k of Object.keys(value)) {\n\t\t\t\tvalue[k] = parseValue(value[k], options);\n\t\t\t}\n\t\t} else {\n\t\t\tret[key] = parseValue(value, options);\n\t\t}\n\t}\n\n\tif (options.sort === false) {\n\t\treturn ret;\n\t}\n\n\treturn (options.sort === true ? Object.keys(ret).sort() : Object.keys(ret).sort(options.sort)).reduce((result, key) => {\n\t\tconst value = ret[key];\n\t\tif (Boolean(value) && typeof value === 'object' && !Array.isArray(value)) {\n\t\t\t// Sort object keys, not values\n\t\t\tresult[key] = keysSorter(value);\n\t\t} else {\n\t\t\tresult[key] = value;\n\t\t}\n\n\t\treturn result;\n\t}, Object.create(null));\n}\n\nexports.extract = extract;\nexports.parse = parse;\n\nexports.stringify = (object, options) => {\n\tif (!object) {\n\t\treturn '';\n\t}\n\n\toptions = Object.assign({\n\t\tencode: true,\n\t\tstrict: true,\n\t\tarrayFormat: 'none',\n\t\tarrayFormatSeparator: ','\n\t}, options);\n\n\tvalidateArrayFormatSeparator(options.arrayFormatSeparator);\n\n\tconst shouldFilter = key => (\n\t\t(options.skipNull && isNullOrUndefined(object[key])) ||\n\t\t(options.skipEmptyString && object[key] === '')\n\t);\n\n\tconst formatter = encoderForArrayFormat(options);\n\n\tconst objectCopy = {};\n\n\tfor (const key of Object.keys(object)) {\n\t\tif (!shouldFilter(key)) {\n\t\t\tobjectCopy[key] = object[key];\n\t\t}\n\t}\n\n\tconst keys = Object.keys(objectCopy);\n\n\tif (options.sort !== false) {\n\t\tkeys.sort(options.sort);\n\t}\n\n\treturn keys.map(key => {\n\t\tconst value = object[key];\n\n\t\tif (value === undefined) {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (value === null) {\n\t\t\treturn encode(key, options);\n\t\t}\n\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value\n\t\t\t\t.reduce(formatter(key), [])\n\t\t\t\t.join('&');\n\t\t}\n\n\t\treturn encode(key, options) + '=' + encode(value, options);\n\t}).filter(x => x.length > 0).join('&');\n};\n\nexports.parseUrl = (input, options) => {\n\toptions = Object.assign({\n\t\tdecode: true\n\t}, options);\n\n\tconst [url, hash] = splitOnFirst(input, '#');\n\n\treturn Object.assign(\n\t\t{\n\t\t\turl: url.split('?')[0] || '',\n\t\t\tquery: parse(extract(input), options)\n\t\t},\n\t\toptions && options.parseFragmentIdentifier && hash ? {fragmentIdentifier: decode(hash, options)} : {}\n\t);\n};\n\nexports.stringifyUrl = (input, options) => {\n\toptions = Object.assign({\n\t\tencode: true,\n\t\tstrict: true\n\t}, options);\n\n\tconst url = removeHash(input.url).split('?')[0] || '';\n\tconst queryFromUrl = exports.extract(input.url);\n\tconst parsedQueryFromUrl = exports.parse(queryFromUrl, {sort: false});\n\n\tconst query = Object.assign(parsedQueryFromUrl, input.query);\n\tlet queryString = exports.stringify(query, options);\n\tif (queryString) {\n\t\tqueryString = `?${queryString}`;\n\t}\n\n\tlet hash = getHash(input.url);\n\tif (input.fragmentIdentifier) {\n\t\thash = `#${encode(input.fragmentIdentifier, options)}`;\n\t}\n\n\treturn `${url}${queryString}${hash}`;\n};\n","/**\r\n * @author Giuliano Collacchioni @2020\r\n */\r\n\r\nimport * as qs from \"query-string\";\r\n\r\nconst DIVIDER: string = \"#R!:\";\r\n\r\n// add a listener to popstate event to stop propagation on option handling\r\nlet catchPopState: (() => void) | null = null;\r\nwindow.addEventListener(\"popstate\", function (event: PopStateEvent): void {\r\n    if (catchPopState == null) {\r\n        return;\r\n    }\r\n    event.stopImmediatePropagation();\r\n    event.stopPropagation();\r\n    catchPopState();\r\n}, true);\r\n\r\nfunction onCatchPopState(onCatchPopState: () => void, once: boolean = false): void {\r\n    if (once) {\r\n        let tmpOnCatchPopState: () => void = onCatchPopState;\r\n        onCatchPopState = () => {\r\n            catchPopState = null;\r\n            tmpOnCatchPopState();\r\n        };\r\n    }\r\n    catchPopState = onCatchPopState;\r\n}\r\n\r\nfunction goTo(href: string, replace: boolean = false): Promise<undefined> {\r\n    return new Promise(resolve => {\r\n        if (href === window.location.href) {\r\n            return resolve();\r\n        }\r\n        onCatchPopState(resolve, true);\r\n        if (replace) {\r\n            window.location.replace(href);\r\n        } else {\r\n            window.location.assign(href);\r\n        }\r\n    });\r\n}\r\n\r\nfunction splitHref(href: string = window.location.href): [string, string] {\r\n    let splitted: string[] = href.split(DIVIDER);\r\n    if (splitted.length > 2) {\r\n        return [\r\n            splitted.slice(0, splitted.length - 1).join(DIVIDER),\r\n            splitted[splitted.length - 1]\r\n        ];\r\n    }\r\n    return [ splitted[0], splitted[1] || \"\" ];\r\n}\r\n\r\nexport type Options = { [key: string]: any };\r\n\r\n/**\r\n * Converts opts to a query-like string\r\n * @param opts\r\n */\r\nfunction optsToStr(opts: Options): string {\r\n    let filteredOpts: Options = {};\r\n    Object.entries(opts).forEach(([key, value]) => {\r\n        if (value !== undefined) {\r\n            filteredOpts[key] = value;\r\n        }\r\n    });\r\n    return qs.stringify(filteredOpts);\r\n}\r\n\r\n/**\r\n * Gets the options stored in the url\r\n */\r\nexport function get(): Options {\r\n    return qs.parse(splitHref()[1]);\r\n}\r\n/**\r\n * Sets the options\r\n * @param opts\r\n */\r\nexport function set(opts: Options): Promise<undefined> {\r\n    let newHref: string = splitHref()[0] + DIVIDER + optsToStr(opts);\r\n    return goTo(newHref, true);\r\n}\r\n/**\r\n * Add an option to those stored in the url\r\n */\r\nexport function add(opt: string, value?: string): Promise<undefined> {\r\n    let opts: Options = get();\r\n    if (opts[opt] === undefined || opts[opt] !== value) {\r\n        opts[opt] = value || null;\r\n        return set(opts);\r\n    }\r\n    return new Promise(resolve => { resolve(); });\r\n}\r\n/**\r\n * Remove given option\r\n * @param opt\r\n */\r\nexport function remove(opt: string): Promise<undefined> {\r\n    let opts: Options = get();\r\n    if (opts[opt] !== undefined) {\r\n        delete opts[opt];\r\n        return set(opts);\r\n    }\r\n    return new Promise(resolve => { resolve(); });\r\n}\r\n\r\n/**\r\n * Go to the given href adding the specified options\r\n * @param href\r\n * @param opts\r\n * @param replace\r\n */\r\nexport function goWith(href: string, opts: Options, replace: boolean = false): Promise<undefined> {\r\n    let newHref: string = splitHref(href)[0] + DIVIDER + optsToStr(opts);\r\n    return goTo(newHref, replace);\r\n}\r\n\r\n/**\r\n * Get the href with the options portion\r\n */\r\nexport function clearHref(): string {\r\n    return splitHref()[0];\r\n}\r\n\r\n// remove options of just loaded page\r\nif (Object.keys(get()).length > 0) {\r\n    set({});\r\n}","/**\r\n * @author Giuliano Collacchioni @2020\r\n */\r\n\r\nimport * as OptionsManager from \"./OptionsManager\";\r\nimport * as PathGenerator from \"./PathGenerator\";\r\n\r\nlet BASE: string = window.location.href.split(\"#\")[0] + \"#\";\r\n\r\nexport function base(value?: string): string {\r\n    if (value != null) {\r\n        BASE = value;\r\n    }\r\n    return BASE;\r\n}\r\nexport function get(): string {\r\n    return PathGenerator.prepare(OptionsManager.clearHref().split(BASE).slice(1).join(BASE));\r\n}\r\nexport function construct(href: string): string {\r\n    switch (href[0]) {\r\n        case \"?\": {\r\n            href = get().split(\"?\")[0] + href;\r\n            break;\r\n        }\r\n        case \"#\": {\r\n            href = get().split(\"#\")[0] + href;\r\n            break;\r\n        }\r\n        default: { break; }\r\n    }\r\n    return BASE + href;\r\n}","/**\r\n * @author Giuliano Collacchioni @2020\r\n */\r\n\r\nimport * as OptionsManager from \"./OptionsManager\";\r\n\r\nimport * as URLManager from \"./URLManager\";\r\nimport { ContextManager } from \"./ContextManager\";\r\n\r\nlet started: boolean = false;\r\n\r\nexport interface IWork {\r\n    finish(): void;\r\n    beginFinish(): void;\r\n    askFinish(): boolean;\r\n    readonly finishing: boolean;\r\n    readonly finished: boolean;\r\n    readonly locking: boolean;\r\n}\r\n\r\nexport interface ILock extends IWork {\r\n    readonly locking: true;\r\n}\r\n\r\nlet works: IWork[] = [];\r\n\r\nlet onworkfinished: [ () => void, any ][] = [];\r\nexport function onWorkFinished<T>(callback: (this: T) => void, context?: T): void {\r\n    if (works.length === 0) {\r\n        callback.call(context || null as any);\r\n        return;\r\n    }\r\n    onworkfinished.push([callback, context || null]);\r\n}\r\n\r\nfunction createWork(locking?: false): IWork;\r\nfunction createWork(locking: true): ILock;\r\nfunction createWork(locking: boolean = false): IWork | ILock {\r\n    let finished: boolean = false;\r\n    let finishing: boolean = false;\r\n    let work: IWork = {\r\n        get locking(): boolean {\r\n            return locking;\r\n        },\r\n        get finished(): boolean {\r\n            return finished;\r\n        },\r\n        get finishing(): boolean {\r\n            return finishing;\r\n        },\r\n        finish(): void {\r\n            if (finished) {\r\n                return;\r\n            }\r\n            finished = true;\r\n            finishing = false;\r\n\r\n            let i: number = works.length - 1;\r\n            for (; i >= 0; i--) {\r\n                if (works[i] === work) {\r\n                    works.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (i >= 0 && works.length === 0) {\r\n                while (onworkfinished.length > 0 && works.length === 0) {\r\n                    let [callback, context] = onworkfinished.shift();\r\n                    callback.call(context || window);\r\n                }\r\n            }\r\n        },\r\n        beginFinish(): void {\r\n            finishing = true;\r\n        },\r\n        askFinish(): boolean {\r\n            return false;\r\n        }\r\n    };\r\n    works.push(work);\r\n    return work;\r\n}\r\n\r\nexport function acquire(): ILock {\r\n    let lock: ILock = createWork(true);\r\n    return lock;\r\n}\r\nfunction isLocked(): boolean {\r\n    return works.some(w => w.locking);\r\n}\r\nlet catchPopState: (() => void) | null = null;\r\nwindow.addEventListener(\"popstate\", event => {\r\n    if (!started || isLocked()) {\r\n        return;\r\n    }\r\n    if (catchPopState == null) {\r\n        handlePopState();\r\n        return;\r\n    }\r\n    event.stopImmediatePropagation();\r\n    catchPopState();\r\n}, true);\r\n\r\nfunction onCatchPopState(onCatchPopState: () => void, once: boolean = false): void {\r\n    if (once) {\r\n        let tmpOnCatchPopState: () => void = onCatchPopState;\r\n        onCatchPopState = () => {\r\n            catchPopState = null;\r\n            tmpOnCatchPopState();\r\n        };\r\n    }\r\n    catchPopState = onCatchPopState;\r\n}\r\n\r\nfunction goTo(href: string, replace: boolean = false): void {\r\n    href = URLManager.construct(href);\r\n    if (window.location.href === href) {\r\n        window.dispatchEvent(new Event(\"popstate\"));\r\n        return;\r\n    }\r\n    if (replace) {\r\n        window.location.replace(href);\r\n    } else {\r\n        window.location.assign(href);\r\n    }\r\n}\r\n\r\nexport function addFront(frontHref: string = \"next\"): Promise<void> {\r\n    let href: string = URLManager.get();\r\n    let work: IWork = createWork();\r\n    return new Promise(resolve => {\r\n        OptionsManager.goWith(URLManager.construct(frontHref), { back: undefined, front: null })\r\n        .then(() => new Promise<void>(resolve => {\r\n            onCatchPopState(resolve, true);\r\n            window.history.go(-1);\r\n        }))\r\n        .then(() => new Promise(resolve => {\r\n            onCatchPopState(resolve, true);\r\n            goTo(href, true);\r\n        }))\r\n        .then(() => {\r\n            work.finish();\r\n            resolve();\r\n        });\r\n    });\r\n}\r\n\r\nexport function addBack(backHref: string = \"\"): Promise<void> {\r\n    let href: string = URLManager.get();\r\n    let work: IWork = createWork();\r\n    return new Promise(resolve => {\r\n        (new Promise(resolve => {\r\n            onCatchPopState(resolve, true);\r\n            window.history.go(-1);\r\n        }))\r\n        .then(() => new Promise(resolve => {\r\n            if (backHref) {\r\n                onCatchPopState(resolve, true);\r\n                goTo(backHref, true);\r\n            } else {\r\n                resolve();\r\n            }\r\n        }))\r\n        .then(() => OptionsManager.set({ back: null, front: undefined }))\r\n        .then(() => new Promise(resolve => {\r\n            onCatchPopState(resolve, true);\r\n            goTo(href);\r\n        }))\r\n        .then(() => {\r\n            work.finish();\r\n            resolve();\r\n        });\r\n    });\r\n}\r\n\r\nlet hasBack: boolean = false;\r\n\r\nlet contextManager: ContextManager = new ContextManager();\r\nexport function index(): number {\r\n    return contextManager.index();\r\n}\r\n\r\nexport function getHREFAt(index: number): string | null {\r\n    return contextManager.get(index);\r\n}\r\n\r\nexport function setContext(context: {\r\n    name: string,\r\n    paths: { path: string, fallback?: boolean }[],\r\n    default?: string | null\r\n}): void {\r\n    return contextManager.setContext(context);\r\n}\r\n\r\nexport function addContextPath(context: string, href: string, isFallback: boolean = false): RegExp {\r\n    return contextManager.addContextPath(context, href, isFallback);\r\n}\r\nexport function setContextDefaultHref(context: string, href: string): void {\r\n    return contextManager.setContextDefaultHref(context, href);\r\n}\r\n\r\nexport function getContext(href: string | null = null): string | null {\r\n    if (href == null) {\r\n        return contextManager.currentContext();\r\n    }\r\n    return contextManager.contextOf(href);\r\n}\r\n\r\nexport function getHREFs(): string[] {\r\n    return contextManager.hrefs();\r\n}\r\n\r\nfunction tryUnlock(): number {\r\n    let locksAsked: number = 0;\r\n    for (let i: number = works.length - 1; i >= 0; i--) {\r\n        let work: IWork = works[i];\r\n        if (work.locking && !work.finishing) {\r\n            if (!work.askFinish()) {\r\n                return -1;\r\n            }\r\n            locksAsked++;\r\n        }\r\n    }\r\n    return locksAsked;\r\n}\r\n\r\nlet workToRelease: IWork | null = null;\r\n\r\nexport function restore(context: string): Promise<void> {\r\n    let locksFinished: number = tryUnlock();\r\n    if (locksFinished === -1) {\r\n        return new Promise((_, reject) => { reject(); });\r\n    }\r\n    let promiseResolve: () => void;\r\n    let promise: Promise<void> = new Promise(resolve => { promiseResolve = resolve;});\r\n    onWorkFinished(() => {\r\n        let previousIndex: number = contextManager.index();\r\n        if (contextManager.restore(context)) {\r\n            let replace: boolean = previousIndex >= contextManager.index();\r\n            workToRelease = createWork();\r\n            onWorkFinished(promiseResolve);\r\n            let href: string = contextManager.get()!;\r\n            let hadBack: boolean = hasBack;\r\n            (new Promise<void>(resolve => {\r\n                if (!replace && !hasBack) {\r\n                    onCatchPopState(resolve, true);\r\n                    goTo(href);\r\n                } else {\r\n                    resolve();\r\n                }\r\n            }))\r\n            .then(() => new Promise<void>(resolve => {\r\n                let index: number = contextManager.index() - 1;\r\n                if (replace && !hasBack) {\r\n                    resolve();\r\n                } else {\r\n                    addBack(contextManager.get(index)!)\r\n                    .then(() => {\r\n                        hasBack = true;\r\n                        resolve();\r\n                    });\r\n                }\r\n            }))\r\n            .then(() => new Promise(resolve => {\r\n                if (hadBack || replace) {\r\n                    onCatchPopState(resolve, true);\r\n                    goTo(href, true);\r\n                } else {\r\n                    resolve();\r\n                }\r\n            }))\r\n            .then(onlanded);\r\n        } else {\r\n            promiseResolve();\r\n        }\r\n    });\r\n    return promise;\r\n}\r\n\r\nexport function assign(href: string): Promise<void> {\r\n    let locksFinished: number = tryUnlock();\r\n    if (locksFinished === -1) {\r\n        return new Promise((_, reject) => { reject(); });\r\n    }\r\n    let promiseResolve: () => void;\r\n    let promise: Promise<void> = new Promise(resolve => { promiseResolve = resolve;});\r\n    onWorkFinished(() => {\r\n        workToRelease = createWork();\r\n        onWorkFinished(promiseResolve);\r\n        goTo(href);\r\n    });\r\n    return promise;\r\n}\r\n\r\nlet replacing: boolean = false;\r\nexport function replace(href: string): Promise<void> {\r\n    let locksFinished: number = tryUnlock();\r\n    if (locksFinished === -1) {\r\n        return new Promise((_, reject) => { reject(); });\r\n    }\r\n    let promiseResolve: () => void;\r\n    let promise: Promise<void> = new Promise(resolve => { promiseResolve = resolve; });\r\n    onWorkFinished(() => {\r\n        workToRelease = createWork();\r\n        onWorkFinished(promiseResolve);\r\n        goTo(href, replacing = true);\r\n    });\r\n    return promise;\r\n}\r\n\r\nexport function go(direction: number): Promise<void> {\r\n    let locksFinished: number = tryUnlock();\r\n    if (locksFinished === -1) {\r\n        return new Promise((resolve, reject) => {\r\n            reject();\r\n        });\r\n    }\r\n    if (direction === 0) {\r\n        throw new Error(\"direction must be different than 0\");\r\n    }\r\n    direction = parseInt(direction as any, 10) + locksFinished;\r\n    if (isNaN(direction)) {\r\n        throw new Error(\"direction must be a number\");\r\n    }\r\n    if (direction === 0) {\r\n        return Promise.resolve();\r\n    }\r\n    let promiseResolve: () => void;\r\n    let promise: Promise<void> = new Promise((resolve, reject) => { promiseResolve = resolve; });\r\n    onWorkFinished(() => {\r\n        let index: number = contextManager.index() + direction;\r\n        if (index < 0 || index >= contextManager.length()) {\r\n            return onlanded();\r\n        }\r\n        workToRelease = createWork();\r\n        onWorkFinished(promiseResolve);\r\n        if (direction > 0) {\r\n            contextManager.index(index - 1);\r\n            window.history.go(1);\r\n        } else {\r\n            contextManager.index(index + 1);\r\n            window.history.go(-1);\r\n        }\r\n    });\r\n    return promise;\r\n}\r\n\r\nexport function start(fallbackContext: string | null = contextManager.getContextNames()[0]): void {\r\n    let href: string = URLManager.get();\r\n    let context: string | null = contextManager.contextOf(href, false);\r\n    if (context == null) {\r\n        if (!fallbackContext) {\r\n            throw new Error(\"must define a fallback context\");\r\n        }\r\n        let defaultHREF: string | null = contextManager.getDefaultOf(fallbackContext);\r\n        if (defaultHREF == null) {\r\n            throw new Error(\"must define a default href for the fallback context\");\r\n        }\r\n        started = true;\r\n        href = defaultHREF;\r\n        workToRelease = createWork();\r\n        onCatchPopState(onlanded, true);\r\n        goTo(defaultHREF, true);\r\n    }\r\n    contextManager.insert(href);\r\n    if (context != null) {\r\n        started = true;\r\n        onlanded();\r\n    }\r\n}\r\n\r\nfunction onlanded(): void {\r\n    window.dispatchEvent(new Event(\"historylanded\"));\r\n    if (workToRelease != null) {\r\n        let work: IWork = workToRelease;\r\n        workToRelease = null;\r\n        work.finish();\r\n    }\r\n}\r\n\r\nfunction handlePopState(): void {\r\n    let options: OptionsManager.Options = OptionsManager.get();\r\n    if (options.locked) {\r\n        onCatchPopState(() => {\r\n            if (OptionsManager.get().locked) {\r\n                handlePopState();\r\n            }\r\n        }, true);\r\n        window.history.go(-1);\r\n        return;\r\n    }\r\n    if (options.front !== undefined) {\r\n        let frontEvent: Event = new Event(\"historyforward\", { cancelable: true });\r\n        window.dispatchEvent(frontEvent);\r\n        if (frontEvent.defaultPrevented) {\r\n            onCatchPopState(() => { return; }, true);\r\n            window.history.go(-1);\r\n            return;\r\n        }\r\n        // should go forward in history\r\n        let backHref: string = contextManager.get()!;\r\n        let href: string = contextManager.goForward();\r\n        (new Promise<void>(resolve => {\r\n            if (hasBack) {\r\n                onCatchPopState(resolve, true);\r\n                window.history.go(-1);\r\n            } else {\r\n                resolve();\r\n            }\r\n        }))\r\n        .then(() => new Promise<void>(resolve => {\r\n            onCatchPopState(resolve, true);\r\n            goTo(href, true);\r\n        }))\r\n        .then(addBack.bind(null, backHref))\r\n        .then(() => new Promise<void>(resolve => {\r\n            if (contextManager.index() < contextManager.length() - 1) {\r\n                onCatchPopState(resolve, true);\r\n                addFront(contextManager.get(contextManager.index() + 1)!).then(resolve);\r\n            } else {\r\n                resolve();\r\n            }\r\n        }))\r\n        .then(() => {\r\n            hasBack = true;\r\n            onlanded();\r\n        });\r\n    } else if (options.back !== undefined) {\r\n        let backEvent: Event = new Event(\"historybackward\", { cancelable: true });\r\n        window.dispatchEvent(backEvent);\r\n        if (backEvent.defaultPrevented) {\r\n            onCatchPopState(() => { return; }, true);\r\n            window.history.go(+1);\r\n            return;\r\n        }\r\n        // should go backward in history\r\n        let frontHref: string = contextManager.get()!;\r\n        let href: string = contextManager.goBackward();\r\n        (new Promise<void>(resolve => {\r\n            if (contextManager.index() > 0) {\r\n                onCatchPopState(resolve, true);\r\n                window.history.go(1);\r\n            } else {\r\n                resolve();\r\n            }\r\n        })).then(() => new Promise<void>(resolve => {\r\n            onCatchPopState(resolve, true);\r\n            goTo(href, true);\r\n        }))\r\n        .then(addFront.bind(null, frontHref))\r\n        .then(() => {\r\n            hasBack = contextManager.index() > 0;\r\n            onlanded();\r\n        });\r\n    } else {\r\n        // should add new page to history\r\n        let href: string = URLManager.get();\r\n        let backHref: string = contextManager.get()!;\r\n        if (href === backHref) {\r\n            return onlanded();\r\n        }\r\n        let replaced: boolean = replacing;\r\n        replacing = false;\r\n        let willHaveBack: boolean = hasBack || !replaced;\r\n        contextManager.insert(href, replaced);\r\n        (new Promise<void>(resolve => {\r\n            if (hasBack && !replaced) {\r\n                onCatchPopState(resolve, true);\r\n                window.history.go(-1);\r\n            } else {\r\n                resolve();\r\n            }\r\n        }))\r\n        .then(() => {\r\n            if (replaced) {\r\n                return Promise.resolve();\r\n            }\r\n            return addBack(backHref);\r\n        })\r\n        .then(() => new Promise(resolve => {\r\n            onCatchPopState(resolve, true);\r\n            goTo(href, true);\r\n        }))\r\n        .then(() => {\r\n            hasBack = willHaveBack;\r\n            onlanded();\r\n        });\r\n    }\r\n}","/**\r\n * @author Giuliano Collacchioni @2020\r\n */\r\n\r\nimport * as OptionsManager from \"./OptionsManager\";\r\nimport * as HistoryManager from \"./HistoryManager\";\r\n\r\nexport type Lock = {\r\n    readonly id: number,\r\n    listen(listener: (event: Event) => void): void;\r\n    unlisten(listener: (event: Event) => void): void;\r\n    unlock(): void;\r\n};\r\n\r\ntype Wrapper = {\r\n    lock: Lock;\r\n    fire(): boolean;\r\n    release(): void;\r\n    beginRelease(start_fn: () => void): void;\r\n};\r\n\r\nlet locks: Wrapper[] = [];\r\n\r\nlet catchPopState: null | (() => void) = null;\r\nwindow.addEventListener(\"popstate\", event => {\r\n    if (catchPopState == null) {\r\n        return handlePopState();\r\n    }\r\n    event.stopImmediatePropagation();\r\n    catchPopState();\r\n}, true);\r\n\r\nfunction onCatchPopState(onCatchPopState: () => void, once: boolean = false): void {\r\n    if (once) {\r\n        let tmpOnCatchPopState: () => void = onCatchPopState;\r\n        onCatchPopState = () => {\r\n            catchPopState = null;\r\n            tmpOnCatchPopState();\r\n        };\r\n    }\r\n    catchPopState = onCatchPopState;\r\n}\r\n\r\nexport function lock(): Promise<Lock> {\r\n    let delegate: EventTarget = new EventTarget();\r\n    let id: number = Date.now();\r\n    let historyLock: HistoryManager.ILock;\r\n    let promiseResolve: (lock: Lock) => void;\r\n    let promise: Promise<Lock> = new Promise<Lock>(resolve => {\r\n        promiseResolve = resolve;\r\n    });\r\n    HistoryManager.onWorkFinished(() => {\r\n        historyLock = HistoryManager.acquire();\r\n        let lock: Wrapper = {\r\n            lock: {\r\n                get id(): number {\r\n                    return id;\r\n                },\r\n                listen(listener: (event: Event) => void): void {\r\n                    delegate.addEventListener(\"navigation\", listener);\r\n                },\r\n                unlisten(listener: (event: Event) => void): void {\r\n                    delegate.removeEventListener(\"navigation\", listener);\r\n                },\r\n                unlock(): void {\r\n                    if (!locks.length || historyLock.finishing) {\r\n                        return;\r\n                    }\r\n                    promise.then(() => {\r\n                        if (locks[locks.length - 1].lock.id === id) {\r\n                            unlock();\r\n                        } else {\r\n                            locks.some((lock, index) => {\r\n                                if (lock.lock.id === id) {\r\n                                    locks.splice(index, 1)[0].release();\r\n                                }\r\n                                return false;\r\n                            });\r\n                        }\r\n                    });\r\n                }\r\n            },\r\n            fire(): boolean {\r\n                let e: Event = new Event(\"navigation\", { cancelable: true });\r\n                delegate.dispatchEvent(e);\r\n                return e.defaultPrevented;\r\n            },\r\n            release(): void {\r\n                historyLock.finish();\r\n            },\r\n            beginRelease(start_fn: () => void): void {\r\n                historyLock.beginFinish();\r\n                promise.then(() => {\r\n                    start_fn();\r\n                });\r\n            }\r\n        };\r\n        historyLock.askFinish = () => {\r\n            if (!lock.fire()) {\r\n                return false;\r\n            }\r\n            lock.lock.unlock();\r\n            return true;\r\n        };\r\n        locks.push(lock);\r\n\r\n        OptionsManager.goWith(\r\n            OptionsManager.clearHref(),\r\n            { ...OptionsManager.get(), locked: lock.lock.id }\r\n        ).then(() => {\r\n            promiseResolve(lock.lock);\r\n        });\r\n    });\r\n    return promise;\r\n}\r\n\r\nexport function unlock(force: boolean = true): boolean {\r\n    let wrapper: Wrapper = locks.splice(locks.length - 1, 1)[0];\r\n    if (wrapper == null) {\r\n        return true;\r\n    }\r\n    if (!force && !wrapper.fire()) {\r\n        return false;\r\n    }\r\n    wrapper.beginRelease(() => {\r\n        onCatchPopState(() => {\r\n            wrapper.release();\r\n        }, true);\r\n        window.history.go(-1);\r\n    });\r\n    return true;\r\n}\r\n\r\nexport function locked(): boolean {\r\n    return locks.length > 0;\r\n}\r\n\r\nlet shouldUnlock: boolean = false;\r\nfunction handlePopState(): void {\r\n    if (locks.length === 0) {\r\n        return;\r\n    }\r\n    let lockId: number = parseInt(OptionsManager.get().locked, 10);\r\n    if (isNaN(lockId)) {\r\n        shouldUnlock = true;\r\n        window.history.go(1);\r\n    } else {\r\n        let lock: Wrapper = locks[locks.length - 1];\r\n        if (lockId === lock.lock.id) {\r\n            if (shouldUnlock && lock.fire()) {\r\n                unlock();\r\n            }\r\n            shouldUnlock = false;\r\n            return;\r\n        } else if (lockId > lock.lock.id) {\r\n            window.history.go(-1);\r\n        } else {\r\n            shouldUnlock = true;\r\n            window.history.go(1);\r\n        }\r\n    }\r\n}","/**\r\n * @author Giuliano Collacchioni @2020\r\n */\r\n\r\nimport { Key} from \"path-to-regexp\";\r\nimport * as qs from \"query-string\";\r\n\r\nimport * as HistoryManager from \"./HistoryManager\";\r\nimport * as NavigationLock from \"./NavigationLock\";\r\nimport * as PathGenerator from \"./PathGenerator\";\r\nimport * as URLManager from \"./URLManager\";\r\n\r\nconst ROUTES: unique symbol = Symbol(\"routes\");\r\nconst REDIRECTIONS: unique symbol = Symbol(\"redirections\");\r\nconst DESTROYED: unique symbol = Symbol(\"destroyed\");\r\n\r\nexport type KeyMap = Map<string, any>;\r\n\r\n/**\r\n * Genera una Map avendo le chiavi e i valori associati in due liste separate\r\n * @param keys\r\n * @param values\r\n */\r\nfunction KeyMapFrom(keys: Array<Key>, values: any[]): Map<string, any> {\r\n    let map: Map<string, any> = new Map();\r\n    keys.forEach((key, index) => {\r\n        map.set(key.name.toString(), values[index]);\r\n    });\r\n    return map;\r\n}\r\n\r\nexport interface ILocation {\r\n    href: string;\r\n    pathname: string;\r\n    hash: string;\r\n    query: string;\r\n    parsedQuery: any;\r\n    hasQueryParam(param: string): boolean;\r\n    getQueryParam(param: string): string | null | undefined;\r\n    addQueryParam(param: string, value: string | null): void;\r\n    removeQueryParam(param: string): void;\r\n    hrefIf(go: string): string;\r\n}\r\nexport interface IRouteCallback {\r\n    (location: ILocation, keymap: KeyMap, redirection: { location: ILocation, keymap: KeyMap } | null): void;\r\n}\r\ninterface IRoute {\r\n    regex: RegExp;\r\n    keys: Array<Key>;\r\n    callback: IRouteCallback;\r\n}\r\ninterface IRedirectionRoute {\r\n    regex: RegExp;\r\n    keys: Array<Key>;\r\n    redirection: string;\r\n}\r\nlet routers: Array<GenericRouter> = [];\r\n\r\nexport function getLocation(href: string = URLManager.get()): ILocation {\r\n    let pathname: string = \"\";\r\n    let hash: string = \"\";\r\n    let query: string = \"\";\r\n    let cachedQuery: { [key: string]: any } | null = null;\r\n    // href = \"/\" + href.replace(/[\\\\\\/]+(?![^(]*[)])/g, \"/\").replace(/^[\\/]+/, \"\").replace(/[\\/]+$/, \"\");\r\n    {\r\n        let split: string[] = href.split(\"#\");\r\n        pathname = split.shift()!;\r\n        hash = split.join(\"#\");\r\n        hash = hash ? \"#\" + hash : \"\";\r\n    }{\r\n        let split: string[] = pathname.split(\"?\");\r\n        pathname = split.shift()!;\r\n        query = split.join(\"?\");\r\n        query = query ? \"?\" + query : \"\";\r\n    }\r\n    pathname = PathGenerator.prepare(pathname);\r\n    return {\r\n        hrefIf: function (go: string): string {\r\n            let oldP: string = pathname;\r\n            let oldH: string = hash;\r\n            let oldQ: string = query;\r\n            this.href = go;\r\n            let hrefIf: string = this.href;\r\n            pathname = oldP;\r\n            hash = oldH;\r\n            query = oldQ;\r\n            return hrefIf;\r\n        },\r\n        get href(): string {\r\n            return pathname + query + hash;\r\n        },\r\n        set href(value: string) {\r\n            if (typeof value !== \"string\") {\r\n                throw new Error(\"href should be a string\");\r\n            }\r\n            if (!value) {\r\n                // refresh\r\n                return;\r\n            }\r\n            // match at start \"//\", \"/\", \"#\" or \"?\"\r\n            let match: RegExpMatchArray | null = value.match(/^([\\/\\\\]{2,})|([\\/\\\\]{1})|([#])|([\\?])/);\r\n            if (match) {\r\n                switch (match[0]) {\r\n                    case \"?\": {\r\n                        query = \"?\" + encodeURI(value.substr(1)).replace(\"#\", \"%23\").replace(\"?\", \"%3F\");\r\n                        break;\r\n                    }\r\n                    case \"#\": {\r\n                        hash = value;\r\n                        break;\r\n                    }\r\n                    case \"/\": {\r\n                        pathname = PathGenerator.prepare(value);\r\n                        hash = \"\";\r\n                        query = \"\";\r\n                        break;\r\n                    }\r\n                    default: {\r\n                        // here only for \"//\", not valid\r\n                        return;\r\n                    }\r\n                }\r\n            } else {\r\n                let path: Array<string> = pathname.split(\"/\");\r\n                // replace last item with the new value\r\n                path.pop();\r\n                path.push(PathGenerator.prepare(value));\r\n                pathname = path.join(\"/\");\r\n                hash = \"\";\r\n                query = \"\";\r\n            }\r\n            // emit?\r\n        },\r\n        get pathname(): string {\r\n            return pathname;\r\n        },\r\n        set pathname(value: string) {\r\n            if (typeof value !== \"string\") {\r\n                throw new Error(\"pathname should be a string\");\r\n            }\r\n            pathname = PathGenerator.prepare(value);\r\n        },\r\n        get hash(): string {\r\n            return hash;\r\n        },\r\n        set hash(value: string) {\r\n            if (typeof value !== \"string\") {\r\n                throw new Error(\"hash should be a string\");\r\n            }\r\n            if (!value) {\r\n                hash = \"\";\r\n                return;\r\n            }\r\n            if (value.indexOf(\"#\") !== 0) {\r\n                value = \"#\" + value;\r\n            }\r\n            hash = value;\r\n        },\r\n        get query(): string {\r\n            return query;\r\n        },\r\n        set query(value: string) {\r\n            if (typeof value !== \"string\") {\r\n                throw new Error(\"query should be a string\");\r\n            }\r\n            cachedQuery = null;\r\n            if (!value) {\r\n                query = \"\";\r\n                return;\r\n            }\r\n            if (value.indexOf(\"?\") !== 0) {\r\n                value = \"?\" + value;\r\n            }\r\n            query = encodeURI(value).replace(\"#\", \"%23\");\r\n        },\r\n        get parsedQuery(): any {\r\n            if (!query) {\r\n                return {};\r\n            }\r\n            if (!cachedQuery) {\r\n                cachedQuery = qs.parse(query.replace(/^\\?/, \"\"));\r\n            }\r\n            return cachedQuery;\r\n        },\r\n        hasQueryParam(param: string): boolean {\r\n            if (!query) {\r\n                return false;\r\n            }\r\n            return this.parsedQuery[param] !== undefined;\r\n        },\r\n        getQueryParam(param: string): string | null | undefined {\r\n            if (!query) {\r\n                return undefined;\r\n            }\r\n            return this.parsedQuery[param];\r\n        },\r\n        addQueryParam(param: string, value: string | null = null): void {\r\n            let newQuery: { [key: string]: any } = { ...this.parsedQuery, [param]: value };\r\n            cachedQuery = null;\r\n            query = qs.stringify(newQuery);\r\n            if (query) {\r\n                query = \"?\" + query;\r\n            }\r\n        },\r\n        removeQueryParam(param: string): void {\r\n            if (!query) {\r\n                return;\r\n            }\r\n            let parsedQuery: { [key: string]: any } = this.parsedQuery;\r\n            delete parsedQuery[param];\r\n            this.query = qs.stringify(parsedQuery);\r\n        }\r\n    };\r\n}\r\n\r\nfunction emitSingle(router: GenericRouter, location?: ILocation): void {\r\n    // se non è disponibile `location` recuperare l'attuale\r\n    let path: string;\r\n    if (location) {\r\n        path = location.pathname;\r\n    } else {\r\n        location = getLocation();\r\n        path = location.pathname;\r\n    }\r\n    // path = PathGenerator.prepare(path); // it is done inside location, is it needed here?\r\n    let redirection: { location: ILocation, keymap: KeyMap } | null = null;\r\n    // check if this route should be redirected\r\n    router[REDIRECTIONS].some(redirectionRoute => {\r\n        let exec: RegExpExecArray | null = redirectionRoute.regex.exec(path as string);\r\n        if (exec) {\r\n            redirection = { location: location as ILocation, keymap: KeyMapFrom(redirectionRoute.keys, exec.slice(1)) };\r\n            location = getLocation(redirectionRoute.redirection);\r\n            path = location.pathname;\r\n            return false;\r\n        }\r\n        return false;\r\n    });\r\n    router[ROUTES].some(route => {\r\n        let exec: RegExpExecArray | null = route.regex.exec(path as string);\r\n        if (exec) {\r\n            route.callback(location as ILocation, KeyMapFrom(route.keys, exec.slice(1)), redirection);\r\n            return true;\r\n        }\r\n        return false;\r\n    });\r\n}\r\nfunction _emit(): void {\r\n    let location: ILocation = getLocation();\r\n    routers.forEach(router => {\r\n        emitSingle(router, location);\r\n    });\r\n}\r\n\r\nlet emitRoute: boolean = true;\r\nfunction onland(): void {\r\n    if (emitRoute) {\r\n        _emit();\r\n    } else {\r\n        emitRoute = true;\r\n    }\r\n}\r\nwindow.addEventListener(\"historylanded\", onland);\r\n\r\nfunction _go(path: string, replace: boolean = false, emit: boolean = true): Promise<void | undefined> {\r\n    let lastEmitRoute: boolean = emitRoute;\r\n    emitRoute = emit;\r\n    return (replace ? HistoryManager.replace(path) : HistoryManager.assign(path)).catch(() => {\r\n        emitRoute = lastEmitRoute;\r\n    });\r\n}\r\n\r\nfunction _throwIfDestroyed(router: GenericRouter): void {\r\n    if (router[DESTROYED]) {\r\n        throw new Error(\"Router destroyed\");\r\n    }\r\n}\r\nclass GenericRouter {\r\n    constructor() {\r\n        routers.push(this);\r\n    }\r\n    [ROUTES]: Array<IRoute> = [];\r\n    [REDIRECTIONS]: Array<IRedirectionRoute> = [];\r\n    [DESTROYED]: boolean = false;\r\n    destroy(): void {\r\n        if (this[DESTROYED]) {\r\n            return;\r\n        }\r\n        let index: number = routers.indexOf(this);\r\n        if (index > -1) {\r\n            routers.splice(index, 1);\r\n        }\r\n        this[DESTROYED] = true;\r\n    }\r\n    /**\r\n     * Segna il percorso specificato come reindirizzamento ad un altro\r\n     * @param path\r\n     * @param redirection\r\n     */\r\n    redirect(path: string, redirection: string): RegExp {\r\n        _throwIfDestroyed(this);\r\n        let keys: Array<Key> = [];\r\n        let regex: RegExp = PathGenerator.generate(path, keys);\r\n        this[REDIRECTIONS].push({ regex, keys, redirection: PathGenerator.prepare(redirection) });\r\n        return regex;\r\n    }\r\n    /**\r\n     * Elimina un reindirizzamento\r\n     * @param path\r\n     */\r\n    unredirect(path: string): void {\r\n        _throwIfDestroyed(this);\r\n        let keys: Array<Key> = [];\r\n        let regex: RegExp = PathGenerator.generate(path, keys);\r\n        let rIndex: number = -1;\r\n        this[ROUTES].some((route, index) => {\r\n            let xSource: string = (regex.ignoreCase ? regex.source.toLowerCase() : regex.source);\r\n            let ySource: string = (route.regex.ignoreCase ? route.regex.source.toLowerCase() : route.regex.source);\r\n            if ((xSource === ySource) && (regex.global === route.regex.global) &&\r\n                (regex.ignoreCase === route.regex.ignoreCase) && (regex.multiline === route.regex.multiline)\r\n            ) {\r\n                rIndex = index;\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n        if (rIndex > -1) {\r\n            this[ROUTES].splice(rIndex, 1);\r\n        }\r\n    }\r\n    /**\r\n     * Associa una funzione ad un percorso\r\n     * @param path\r\n     * @param callback\r\n     */\r\n    route(path: string, callback: IRouteCallback): RegExp {\r\n        _throwIfDestroyed(this);\r\n        let keys: Array<Key> = [];\r\n        let regex: RegExp = PathGenerator.generate(path, keys);\r\n        this[ROUTES].push({ regex, keys, callback });\r\n        return regex;\r\n    }\r\n    /**\r\n     * Elimina la funzione associata al percorso\r\n     * @param path\r\n     */\r\n    unroute(path: string): void {\r\n        _throwIfDestroyed(this);\r\n        let keys: Array<Key> = [];\r\n        let regex: RegExp = PathGenerator.generate(path, keys);\r\n        let rIndex: number = -1;\r\n        this[ROUTES].some((route, index) => {\r\n            let xSource: string = (regex.ignoreCase ? regex.source.toLowerCase() : regex.source);\r\n            let ySource: string = (route.regex.ignoreCase ? route.regex.source.toLowerCase() : route.regex.source);\r\n            if ((xSource === ySource) && (regex.global === route.regex.global) &&\r\n                (regex.ignoreCase === route.regex.ignoreCase) && (regex.multiline === route.regex.multiline)\r\n            ) {\r\n                rIndex = index;\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n        if (rIndex > -1) {\r\n            this[ROUTES].splice(rIndex, 1);\r\n        }\r\n    }\r\n    emit(): void {\r\n        emitSingle(this);\r\n    }\r\n}\r\n\r\n// interface IMainRouter extends GenericRouter {\r\n//     /**\r\n//      * Crea un router separato dal principale\r\n//      */\r\n//     create(): GenericRouter;\r\n//     setQueryParam(param: string, value: string | null | undefined, options?: { replace?: boolean, emit?: boolean }): Promise<undefined>;\r\n//     go(path: string, options?: { replace?: boolean, emit?: boolean }): Promise<undefined>;\r\n//     go(index: number, options?: { emit: boolean }): Promise<undefined>;\r\n//     base: string;\r\n//     location: ILocation;\r\n//     /**\r\n//      * Blocca la navigazione\r\n//      */\r\n//     lock(/* ghost?: boolean */): Promise<NavigationLock.Lock>;\r\n//     /**\r\n//      * Sblocca la navigazione\r\n//      */\r\n//     unlock(force?: boolean): boolean;\r\n//     locked: boolean;\r\n//     getContext(href?: string): string | null;\r\n//     /**\r\n//      * Associa un percorso ad un contesto\r\n//      * @param context\r\n//      * @param href\r\n//      * @param isFallbackContext\r\n//      * @param canChain\r\n//      */\r\n//     addContextPath(context: string, href: string, isFallbackContext?: boolean, canChain?: boolean): RegExp;\r\n//     /**\r\n//      * Imposta il percorso predefinito di un contesto\r\n//      * @param context\r\n//      * @param href\r\n//      */\r\n//     setContextDefaultHref(context: string, href: string): void;\r\n//     /**\r\n//      * Imposta un contesto\r\n//      * @param this\r\n//      * @param context\r\n//      */\r\n//     setContext(context: {\r\n//         name: string,\r\n//         paths: { path: string, fallback?: boolean }[],\r\n//         default?: string\r\n//     }): void;\r\n//     restoreContext(context: string, defaultHref?: string): Promise<void>;\r\n//     emit(single?: boolean): void;\r\n//     // start(startingContext: string, organizeHistory?: boolean): boolean;\r\n//     start(startingContext: string): void;\r\n//     getLocationAt(index: number): ILocation | null;\r\n//     index(): number;\r\n// }\r\n\r\nlet main: GenericRouter = new GenericRouter();\r\n\r\nexport function redirect(path: string, redirection: string): RegExp {\r\n    return main.redirect(path, redirection);\r\n}\r\nexport function unredirect(path: string): void {\r\n    return main.unredirect(path);\r\n}\r\nexport function route(path: string, callback: IRouteCallback): RegExp {\r\n    return main.route(path, callback);\r\n}\r\nexport function unroute(path: string): void {\r\n    return main.unroute(path);\r\n}\r\n// :TODO:\r\n// main.start = function (startingContext: string, organizeHistory: boolean = true): boolean {\r\nexport function start (startingContext: string): void {\r\n    return HistoryManager.start(startingContext);\r\n}\r\nexport function index(): number {\r\n    return HistoryManager.index();\r\n}\r\nexport function getLocationAt(index: number): ILocation | null {\r\n    let href: string | null = HistoryManager.getHREFAt(index);\r\n    if (href == null) {\r\n        return null;\r\n    }\r\n    return getLocation(href);\r\n}\r\nexport function addContextPath(context: string, href: string, isFallback: boolean = false): RegExp {\r\n    return HistoryManager.addContextPath(context, href, isFallback);\r\n}\r\nexport function setContextDefaultHref(context: string, href: string): void {\r\n    return HistoryManager.setContextDefaultHref(context, href);\r\n}\r\nexport function setContext(context: {\r\n    name: string,\r\n    paths: { path: string, fallback?: boolean }[],\r\n    default?: string\r\n}): void {\r\n    return HistoryManager.setContext(context);\r\n}\r\nexport function getContext(href?: string): string | null {\r\n    return HistoryManager.getContext(href);\r\n}\r\nexport function restoreContext(context: string, defaultHref?: string): Promise<void> {\r\n    return HistoryManager.restore(context);\r\n}\r\nexport function emit(single: boolean = false): void {\r\n    if (single) {\r\n        return emitSingle(main);\r\n    }\r\n    return _emit();\r\n}\r\nexport function create(): GenericRouter {\r\n    return new GenericRouter();\r\n}\r\nexport function go(path_index: string | number, options: {\r\n    emit: boolean\r\n    replace?: boolean,\r\n}): Promise<undefined> {\r\n    // tslint:disable-next-line: typedef\r\n    let path_index_type = typeof path_index;\r\n    if (path_index_type !== \"string\" && path_index_type !== \"number\") {\r\n        throw new Error(\"router.go should receive an url string or a number\");\r\n    }\r\n    // let promiseResolve: () => void;\r\n    options = { ...options };\r\n    return new Promise((promiseResolve: () => void, promiseReject: () => void) => {\r\n        let goingEvent: CustomEvent<{\r\n            direction: string | number, replace?: boolean, emit: boolean\r\n        }> = new CustomEvent<{ direction: string | number, replace?: boolean, emit: boolean }>(\r\n            \"router:going\",\r\n            {\r\n                detail: {\r\n                    direction: path_index,\r\n                    ...options\r\n                },\r\n                cancelable: true\r\n            }\r\n        );\r\n        window.dispatchEvent(goingEvent);\r\n        if (goingEvent.defaultPrevented) {\r\n            promiseReject();\r\n            return;\r\n        }\r\n        if (path_index_type === \"string\") {\r\n            _go(\r\n                path_index as string,\r\n                (options && options.replace) || false,\r\n                (options == null || options.emit == null) ? true : options.emit\r\n            ).then(promiseResolve);\r\n        } else {\r\n            let lastEmitRoute: boolean = emitRoute;\r\n            emitRoute = options.emit == null ? true : options.emit;\r\n            HistoryManager.go(path_index as number).then(promiseResolve, () => {\r\n                emitRoute = lastEmitRoute;\r\n            });\r\n        }\r\n    });\r\n}\r\nexport function setQueryParam(param: string, value: string | null | undefined, options: {\r\n    emit: boolean,\r\n    replace?: boolean\r\n}): Promise<undefined> {\r\n    let promiseResolve: () => void;\r\n    let promise: Promise<undefined> = new Promise(resolve => { promiseResolve = resolve;});\r\n    HistoryManager.onWorkFinished(() => {\r\n        let location: ILocation = getLocation();\r\n        if (value === undefined) {\r\n            location.removeQueryParam(param);\r\n        } else {\r\n            location.addQueryParam(param, value);\r\n        }\r\n        go(location.href, options).then(promiseResolve);\r\n    });\r\n    return promise;\r\n}\r\nexport function lock(): Promise<NavigationLock.Lock> {\r\n    return NavigationLock.lock();\r\n}\r\nexport function unlock(force: boolean = true): boolean {\r\n    return NavigationLock.unlock(force);\r\n}\r\nexport function destroy(): void {\r\n    throw new Error(\"cannot destroy main Router\");\r\n}\r\nexport function getBase(): string {\r\n    return URLManager.base();\r\n}\r\nexport function setBase(newBase: string): void {\r\n    URLManager.base(newBase.replace(/[\\/]+$/, \"\"));\r\n    _emit();\r\n}\r\nexport function isLocked(): boolean {\r\n    return NavigationLock.locked();\r\n}\r\n\r\nexport type Redirection = { location: ILocation, keymap: KeyMap };\r\nexport * as NavigationLock from \"./NavigationLock\";","interface ILock {\r\n    release(): void;\r\n    beginRelease(start_fn: () => void): void;\r\n    readonly releasing: boolean;\r\n    readonly released: boolean;\r\n    onrelease<T>(callback: (this: T) => void, context?: T): void;\r\n}\r\n\r\nlet locks: ILock[] = [];\r\nexport function lock(locking_fn: (this: ILock, lock: ILock) => boolean | void): Promise<ILock> {\r\n    let released: boolean = false;\r\n    let releasing: boolean = false;\r\n    let onrelease: [() => void, any][] = [];\r\n    let promise: Promise<ILock>;\r\n    let lock: ILock = {\r\n        get released(): boolean {\r\n            return released;\r\n        },\r\n        get releasing(): boolean {\r\n            return releasing;\r\n        },\r\n        release(): void {\r\n            if (released) {\r\n                return;\r\n            }\r\n            released = true;\r\n            releasing = false;\r\n\r\n            let i: number = locks.length - 1;\r\n            for (; i >= 0; i--) {\r\n                if (locks[i] === lock) {\r\n                    locks.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n            if (i >= 0) {\r\n                onrelease.forEach(([callback, context]) => {\r\n                    callback.call(context || null);\r\n                });\r\n            }\r\n        },\r\n        beginRelease(start_fn: () => void): void {\r\n            releasing = true;\r\n            start_fn();\r\n        },\r\n        onrelease<T>(callback: (this: T) => void, context: T = null as any): void {\r\n            onrelease.push([callback, context || null]);\r\n        }\r\n    };\r\n    return promise = new Promise<ILock>(resolve => {\r\n        ondone(() => {\r\n            let result: boolean | void = locking_fn.call(lock, lock);\r\n            locks.push(lock);\r\n            if (result !== false && result !== void 0) {\r\n                lock.release();\r\n            }\r\n            resolve(lock);\r\n        });\r\n    });\r\n}\r\n\r\nexport function locked(): boolean {\r\n    return locks.length > 0 && locks.every(lock => !lock.releasing && !lock.released);\r\n}\r\n\r\nlet currentWork: number = -1;\r\nlet working: number = 0;\r\nlet ondoneCallbacks: [() => void, any][] = [];\r\nfunction completeWork(): void {\r\n    if (currentWork === -1) {\r\n        return;\r\n    }\r\n    if (--working === 0) {\r\n        currentWork = -1;\r\n        while (ondoneCallbacks.length && currentWork === -1) {\r\n            let [callback, context] = ondoneCallbacks.shift();\r\n            callback.call(context || null);\r\n        }\r\n    }\r\n}\r\n\r\nfunction ondoneWork<T>(fn: (this: T) => void, context: T, workId: number): void {\r\n    if (currentWork !== -1 && currentWork !== workId) {\r\n        ondoneCallbacks.push([fn, context || null]);\r\n        return;\r\n    }\r\n    fn.call(context || null as any);\r\n}\r\n\r\nexport function startWork(start_fn: (complete: () => void, id: number) => void, id: number = Date.now()): number {\r\n    if (locked()) {\r\n        console.error(\"navigation is locked\");\r\n        return -1;\r\n    }\r\n    let completed: boolean = false;\r\n    ondoneWork(() => {\r\n        currentWork = id;\r\n        working++;\r\n        start_fn(() => {\r\n            if (completed) {\r\n                return;\r\n            }\r\n            completed = true;\r\n            completeWork();\r\n        }, id);\r\n    }, null, id);\r\n    return id;\r\n}\r\n\r\nexport function ondone<T>(fn: (this: T) => void, context?: T): void {\r\n    if (working) {\r\n        ondoneCallbacks.push([fn, context || null]);\r\n        return;\r\n    }\r\n    fn.call(context || null as any);\r\n}"],"names":["PathGenerator.generate","decodeComponent","qs.stringify","qs.parse","get","PathGenerator.prepare","OptionsManager.clearHref","catchPopState","onCatchPopState","goTo","URLManager.construct","URLManager.get","OptionsManager.goWith","OptionsManager.set","OptionsManager.get","handlePopState","HistoryManager.onWorkFinished","HistoryManager.acquire","replace","HistoryManager.replace","HistoryManager.assign","start","HistoryManager.start","index","HistoryManager.index","HistoryManager.getHREFAt","addContextPath","HistoryManager.addContextPath","setContextDefaultHref","HistoryManager.setContextDefaultHref","setContext","HistoryManager.setContext","getContext","HistoryManager.getContext","HistoryManager.restore","go","HistoryManager.go","lock","NavigationLock.lock","unlock","NavigationLock.unlock","URLManager.base","isLocked","NavigationLock.locked","locks","locked"],"mappings":"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"}